#!/bin/sh
set -e

# Lint only staged files to avoid failing on unrelated code
FILES=$(git diff --cached --name-only --diff-filter=ACM | grep -E '\\.(ts|tsx|js|jsx)$' || true)
if [ -n "$FILES" ]; then
	npx eslint $FILES
fi

# Type-check the project
npm run type-check

# If a test script exists, run it; otherwise skip
npm run | grep -q " test" && npm test || echo "[pre-commit] No test script defined; skipping tests."
